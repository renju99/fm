<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Energy Benchmark List View -->
    <record id="view_energy_benchmark_list" model="ir.ui.view">
        <field name="name">facilities.energy.benchmark.list</field>
        <field name="model">facilities.energy.benchmark</field>
        <field name="arch" type="xml">
            <list string="Energy Benchmarks" 
                  decoration-info="is_active == True"
                  create="true" edit="true" delete="true">
                <field name="name"/>
                <field name="benchmark_type"/>
                <field name="facility_type"/>
                <field name="benchmark_value"/>
                <field name="unit_of_measure"/>
                <field name="data_source"/>
                <field name="effective_date"/>
                <field name="expiry_date"/>
                <field name="is_active" widget="boolean_toggle"/>
                <field name="country_id" optional="hide"/>
                <field name="climate_zone" optional="hide"/>
            </list>
        </field>
    </record>

    <!-- Energy Benchmark Form View -->
    <record id="view_energy_benchmark_form" model="ir.ui.view">
        <field name="name">facilities.energy.benchmark.form</field>
        <field name="model">facilities.energy.benchmark</field>
        <field name="arch" type="xml">
            <form string="Energy Benchmark">
                <header>
                    <button name="action_create_default_benchmarks" type="object" 
                            string="Create Default Benchmarks" class="btn-secondary"/>
                    <field name="is_active" widget="boolean_button" options='{"terminology": "active"}'/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    
                    <group>
                        <group name="basic_info" string="Basic Information">
                            <field name="benchmark_code"/>
                            <field name="benchmark_type"/>
                            <field name="benchmark_value"/>
                            <field name="unit_of_measure"/>
                        </group>
                        <group name="scope" string="Scope">
                            <field name="facility_type"/>
                            <field name="climate_zone"/>
                            <field name="building_size_category"/>
                            <field name="country_id"/>
                            <field name="state_id"/>
                        </group>
                    </group>
                    
                    <group>
                        <group name="thresholds" string="Performance Thresholds">
                            <field name="excellent_threshold"/>
                            <field name="good_threshold"/>
                            <field name="average_threshold"/>
                            <field name="below_average_threshold"/>
                        </group>
                        <group name="data_source" string="Data Source">
                            <field name="data_source"/>
                            <field name="data_source_reference"/>
                            <field name="data_collection_date"/>
                            <field name="sample_size"/>
                        </group>
                    </group>
                    
                    <group>
                        <group name="validity" string="Validity">
                            <field name="effective_date"/>
                            <field name="expiry_date"/>
                            <field name="currency_id"/>
                        </group>
                        <group name="notes" string="Documentation">
                            <field name="notes" nolabel="1" placeholder="Additional notes..."/>
                        </group>
                    </group>
                    
                    <notebook>
                        <page string="Methodology" name="methodology">
                            <group>
                                <field name="methodology" nolabel="1" placeholder="Describe the methodology used to establish this benchmark..."/>
                            </group>
                        </page>
                        <page string="Assumptions" name="assumptions">
                            <group>
                                <field name="assumptions" nolabel="1" placeholder="List any assumptions made in establishing this benchmark..."/>
                            </group>
                        </page>
                        <page string="Limitations" name="limitations">
                            <group>
                                <field name="limitations" nolabel="1" placeholder="Describe any limitations of this benchmark..."/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- Energy Benchmark Search View -->
    <record id="view_energy_benchmark_search" model="ir.ui.view">
        <field name="name">facilities.energy.benchmark.search</field>
        <field name="model">facilities.energy.benchmark</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="benchmark_type"/>
                <field name="facility_type"/>
                <field name="data_source"/>
                <field name="country_id"/>
                
                <filter string="Active Benchmarks" name="active" domain="[('is_active', '=', True)]"/>
                <filter string="Energy Intensity" name="energy_intensity" domain="[('benchmark_type', '=', 'energy_intensity')]"/>
                <filter string="Water Intensity" name="water_intensity" domain="[('benchmark_type', '=', 'water_intensity')]"/>
                <filter string="Cost Benchmarks" name="cost" domain="[('benchmark_type', 'in', ['cost_per_sqm', 'cost_per_occupant'])]"/>
                <filter string="Office Buildings" name="office" domain="[('facility_type', '=', 'office')]"/>
                
            <filter string="Benchmark Type" name="group_benchmark_type" context="{'group_by': 'benchmark_type'}"/>
            <filter string="Facility Type" name="group_facility_type" context="{'group_by': 'facility_type'}"/>
            <filter string="Data Source" name="group_data_source" context="{'group_by': 'data_source'}"/>
            <filter string="Country" name="group_country" context="{'group_by': 'country_id'}"/>
            </search>
        </field>
    </record>

    <!-- Energy Benchmark Actions -->
    <record id="action_energy_benchmark" model="ir.actions.act_window">
        <field name="name">Energy Benchmarks</field>
        <field name="res_model">facilities.energy.benchmark</field>
        <field name="view_mode">list,form</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first energy benchmark!
            </p>
            <p>
                Energy benchmarks help you compare your facility's energy performance
                against industry standards and identify opportunities for improvement.
            </p>
        </field>
    </record>

    <!-- Energy Benchmark Report List View -->
    <record id="view_energy_benchmark_report_list" model="ir.ui.view">
        <field name="name">facilities.energy.benchmark.report.list</field>
        <field name="model">facilities.energy.benchmark.report</field>
        <field name="arch" type="xml">
            <list string="Energy Benchmark Reports" 
                  decoration-info="state == 'draft'"
                  decoration-success="state == 'generated'"
                  decoration-muted="state == 'archived'"
                  create="true" edit="true" delete="true">
                <field name="name"/>
                <field name="benchmark_id"/>
                <field name="report_period_start"/>
                <field name="report_period_end"/>
                <field name="state" widget="statusbar"/>
                <field name="total_facilities"/>
                <field name="facilities_above_benchmark"/>
                <field name="facilities_at_benchmark"/>
                <field name="facilities_below_benchmark"/>
                <field name="generated_date" optional="hide"/>
                <field name="generated_by_id" optional="hide"/>
            </list>
        </field>
    </record>

    <!-- Energy Benchmark Report Form View -->
    <record id="view_energy_benchmark_report_form" model="ir.ui.view">
        <field name="name">facilities.energy.benchmark.report.form</field>
        <field name="model">facilities.energy.benchmark.report</field>
        <field name="arch" type="xml">
            <form string="Energy Benchmark Report">
                <header>
                    <button name="action_generate_report" type="object" string="Generate Report" 
                            invisible="state != 'draft'" class="btn-primary"/>
                    <button name="action_publish_report" type="object" string="Publish Report" 
                            invisible="state != 'generated'" class="btn-success"/>
                    <button name="action_archive_report" type="object" string="Archive Report" 
                            invisible="state == 'archived'" class="btn-secondary"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,generated,published"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>
                    
                    <group>
                        <group name="report_config" string="Report Configuration">
                            <field name="benchmark_id"/>
                            <field name="report_period_start"/>
                            <field name="report_period_end"/>
                        </group>
                        <group name="summary" string="Summary">
                            <field name="total_facilities"/>
                            <field name="facilities_above_benchmark"/>
                            <field name="facilities_at_benchmark"/>
                            <field name="facilities_below_benchmark"/>
                        </group>
                    </group>
                    
                    <group>
                        <group name="generation_info" string="Generation Information">
                            <field name="generated_by_id"/>
                            <field name="generated_date"/>
                        </group>
                    </group>
                    
                    <notebook>
                        <page string="Benchmark Results" name="results">
                            <field name="benchmark_results_ids" readonly="1">
                                <list string="Benchmark Results" create="false" edit="false" delete="false">
                                    <field name="facility_name"/>
                                    <field name="actual_value"/>
                                    <field name="benchmark_value"/>
                                    <field name="performance_level" widget="badge" decoration-success="performance_level == 'excellent'" decoration-info="performance_level == 'good'" decoration-warning="performance_level == 'average'" decoration-danger="performance_level in ['below_average', 'poor']"/>
                                    <field name="variance_percentage"/>
                                    <field name="comparison_status" widget="badge" decoration-success="comparison_status == 'above_benchmark'" decoration-info="comparison_status == 'at_benchmark'" decoration-warning="comparison_status == 'below_benchmark'"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- Energy Benchmark Report Search View -->
    <record id="view_energy_benchmark_report_search" model="ir.ui.view">
        <field name="name">facilities.energy.benchmark.report.search</field>
        <field name="model">facilities.energy.benchmark.report</field>
        <field name="arch" type="xml">
            <search>
                <field name="name"/>
                <field name="benchmark_id"/>
                <field name="generated_by_id"/>
                <field name="report_period_start"/>
                <field name="report_period_end"/>
                
                <filter string="Draft Reports" name="draft" domain="[('state', '=', 'draft')]"/>
                <filter string="Generated Reports" name="generated" domain="[('state', '=', 'generated')]"/>
                <filter string="Published Reports" name="published" domain="[('state', '=', 'published')]"/>
                <filter string="This Month" name="this_month" domain="[('report_period_start', '>=', (context_today().replace(day=1)))]"/>
                <filter string="This Quarter" name="this_quarter" domain="[('report_period_start', '>=', (context_today().replace(month=((context_today().month-1)//3)*3+1, day=1)))]"/>
                
            <filter string="Benchmark" name="group_benchmark" context="{'group_by': 'benchmark_id'}"/>
            <filter string="State" name="group_state" context="{'group_by': 'state'}"/>
            <filter string="Generated By" name="group_generated_by" context="{'group_by': 'generated_by_id'}"/>
            <filter string="Report Period" name="group_period" context="{'group_by': 'report_period_start:month'}"/>
            </search>
        </field>
    </record>

    <!-- Energy Benchmark Report Actions -->
    <record id="action_energy_benchmark_report" model="ir.actions.act_window">
        <field name="name">Energy Benchmark Reports</field>
        <field name="res_model">facilities.energy.benchmark.report</field>
        <field name="view_mode">list,form</field>
        <field name="context">{}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first energy benchmark report!
            </p>
            <p>
                Benchmark reports compare your facilities' energy performance against
                industry benchmarks and provide actionable insights for improvement.
            </p>
        </field>
    </record>

</odoo>
